(function(e){function t(t){for(var r,i,a=t[0],c=t[1],u=t[2],l=0,h=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);_&&_(t);while(h.length)h.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var _=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"015f":function(e,t,n){"use strict";n("6087")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],attrs:{id:"menu"}},[r("h1",[e._v("dept-quiz")]),r("h2",[e._v("Choisis un jeu")]),r("div",{attrs:{id:"games"}},e._l(e.games,(function(t){return r("div",{key:t.id,staticClass:"game",on:{click:function(n){return e.select(n,t)}}},[r("img",{attrs:{src:n("95cd")("./"+t.image)}}),r("h3",[e._v(e._s(t.label))])])})),0)]),r("Game",{directives:[{name:"show",rawName:"v-show",value:e.showGame,expression:"showGame"}],ref:"game"})],1)},s=[],i=n("1da1"),a=(n("96cf"),n("ac1f"),n("5319"),n("d3b7"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("l-map",{ref:"map",attrs:{id:"map",zoom:e.zoom,center:e.center}},[n("l-tile-layer",{attrs:{url:e.url,attribution:e.attribution}}),e.dispGeojson?n("l-geo-json",{attrs:{geojson:e.geojson,options:e.options,"options-style":e.styleFunction}}):e._e()],1),n("div",{attrs:{id:"panel"}},[n("div",{attrs:{id:"question"}},[n("h1",[e._v(e._s(e.question))])]),n("div",{attrs:{id:"result"}},[n("h2",[e._v(e._s(e.result))])]),n("div",{attrs:{id:"progression"}},[n("h2",[e._v(e._s(e.current)+" / "+e._s(e.solutionIds.length))])]),n("div",{attrs:{id:"score"}},[n("h2",[e._v("Score : "+e._s(e.score))])]),n("div",{attrs:{id:"bonus"}},[n("h2",[e._v("Bonus "+e._s(e.bonus)+"%")])]),n("button",{attrs:{id:"restart"},on:{click:function(t){return e.restart()}}},[e._v("Restart")]),n("button",{attrs:{id:"quit"},on:{click:function(t){return e.quit()}}},[e._v("Quit")]),n("button",{attrs:{id:"showHighscores"},on:{click:function(t){return e.showHighscores()}}},[e._v("Highscores")])]),n("Highscores",{ref:"highscores",attrs:{id:"highscores"}}),n("SaveScore",{ref:"savescore",attrs:{id:"savescore"}})],1)}),c=[],u=(n("d81d"),n("2699")),_=n("a40a"),l=n("044a"),h=n("e11e"),p=n.n(h),f=(n("6cc5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.showHighscores,expression:"showHighscores"}],attrs:{id:"highscores"}},[n("h1",[e._v("Highscores")]),n("h2",[e._v(e._s(e.game.label))]),n("div",{attrs:{id:"players"}},[n("table",e._l(e.players,(function(t){return n("tr",{key:t.position},[n("th",{attrs:{id:"player-position"}},[e._v(e._s(t.position))]),n("th",{attrs:{id:"player-name"}},[e._v(e._s(t.name))]),n("th",{attrs:{id:"player-score"}},[e._v(e._s(t.score))])])})),0)]),n("br"),n("button",{attrs:{id:"close"},on:{click:function(t){return e.close()}}},[e._v("Close")])])}),d=[],m=n("b9ac"),g=m["a"],v=(n("015f"),n("2877")),w=Object(v["a"])(g,f,d,!1,null,null,null),b=w.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.showSaveScore,expression:"showSaveScore"}],attrs:{id:"save-score"}},[n("h1",[e._v("Save your score")]),n("h2",[e._v("You scored "+e._s(e.score)+" at "+e._s(e.game.label))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.playerName,expression:"playerName"}],attrs:{id:"input-player-name",type:"text",placeholder:"Enter your name",required:"",minLength:"1",maxLength:"25",size:"14"},domProps:{value:e.playerName},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save()},input:function(t){t.target.composing||(e.playerName=t.target.value)}}}),n("div",{attrs:{id:"buttons"}},[n("button",{attrs:{id:"save"},on:{click:function(t){return e.save()}}},[e._v("Save")]),n("button",{attrs:{id:"close"},on:{click:function(t){return e.close()}}},[e._v("Cancel")])])])},j=[],O={name:"SaveScore",data:function(){return{game:[],score:0,playerName:"anonymous",showSaveScore:!1}},methods:{show:function(e,t){this.game=e,this.score=t,this.showSaveScore=!0},save:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=window.location.origin.replace("8080","3000"),t.next=3,fetch(n+"/highscore?type=i&game="+e.game.id+"&name="+e.playerName+"&score="+e.score);case 3:return r=t.sent,t.next=6,r.json();case 6:e.showSaveScore=!1,e.$parent.showHighscores();case 8:case"end":return t.stop()}}),t)})))()},close:function(){this.showSaveScore=!1}}},x=O,E=(n("f575"),Object(v["a"])(x,y,j,!1,null,null,null)),k=E.exports;p.a.Icon.Default.imagePath="https://unpkg.com/leaflet@1.3.4/dist/images/";var M={name:"Game",components:{"l-map":u["a"],"l-tile-layer":_["a"],LGeoJson:l["a"],Highscores:b,SaveScore:k},data:function(){return{game:[],question:"",result:"",score:0,bonus:0,playing:!1,departmentName:"",geojson:null,solutionIds:[],current:0,dispGeojson:!0,map:null,zoom:2,center:{lat:0,lng:0},url:"http://tile.stamen.com/watercolor/{z}/{x}/{y}.jpg",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},computed:{options:function(){return{onEachFeature:this.onEachFeature}},styleFunction:function(){return function(){return{weight:2,color:"#ECEFF1",opacity:1,fillColor:"#e4ce7f",fillOpacity:.5}}}},created:function(){this.question="loading"},methods:{launch:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.game=e,console.log("starting game "+t.game.id),n.next=4,t.load();case 4:t.shufflize(),t.start();case 6:case"end":return n.stop()}}),n)})))()},load:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("loading geojson "+e.game.geojson),n=window.location.origin.replace("8080","3000"),t.next=4,fetch(n+"/geojson?file="+e.game.geojson);case 4:return r=t.sent,t.next=7,r.json();case 7:o=t.sent,e.geojson=o,console.log(e.geojson.features.length+" features loaded");case 10:case"end":return t.stop()}}),t)})))()},shuffleArray:function(e){var t=e.length;while(0!==t){var n=Math.floor(Math.random()*t);t-=1;var r=e[t];e[t]=e[n],e[n]=r}return e},shufflize:function(){console.log("shuffling solution"),this.solutionIds=new Array(this.geojson.features.length);for(var e=0;e<this.geojson.features.length;e++)this.solutionIds[e]=e;this.solutionIds=this.shuffleArray(this.solutionIds)},start:function(){console.log("game start"),this.result="Sélectionne "+this.game.typeLabel+" sur la carte",this.current=-1,this.progression=0,this.score=0,this.bonus=100,this.playing=!0,this.map=this.$refs.map;var e=new h["featureGroup"];this.map.mapObject.eachLayer((function(t){void 0!=t.feature&&e.addLayer(t)})),this.map.mapObject.flyToBounds(e.getBounds(),{padding:[20,20]}),this.next()},next:function(){console.log("next"),this.current++,this.current===this.geojson.features.length?this.end():(this.departmentName=this.geojson.features[this.solutionIds[this.current]].properties[this.game.field],this.question="Où est "+this.game.typeLabel+" "+this.departmentName+" ?")},onClic:function(e,t){if(this.playing){if(this.departmentName===e)this.result="Correct",this.score+=this.bonus,this.bonus+=20,t.feature.properties.won=!0,t.setStyle({fillColor:"green"});else{this.result="Incorrect ("+e+")",this.bonus=100,t.setStyle({fillColor:"red"});var n=new h["featureGroup"];this.map.mapObject.eachLayer(function(e){void 0!=e.feature&&e.feature.properties[this.game.field]===this.departmentName&&(console.log(e),n.addLayer(e),e.setStyle({fillColor:"orange"}))}.bind(this)),console.log(n.getBounds()),this.map.mapObject.flyToBounds(n.getBounds(),{padding:[20,20]})}this.next()}},end:function(){console.log("end of game"),this.result="Game over",this.playing=!1,this.$refs.savescore.show(this.game,this.score)},quit:function(){console.log("quit game"),this.$parent.quitGame()},restart:function(){console.log("restart"),this.launch(this.game)},showHighscores:function(){this.$refs.highscores.show(this.game)},onEachFeature:function(e,t){var n=this;t.on("mouseover",(function(){this.setStyle({fillColor:"#e4ce30"})})),t.on("mouseout",(function(){this.feature.properties.won?this.setStyle({fillColor:"green"}):this.setStyle({fillColor:"#e4ce7f"})})),t.on("click",(function(){console.log("click on "+e.properties[n.game.field]),n.onClic(e.properties[n.game.field],this)}))}}},P=M,S=(n("f830"),Object(v["a"])(P,a,c,!1,null,"790993ba",null)),C=S.exports,D={name:"App",components:{Game:C},data:function(){return{showMenu:!0,showGame:!0,games:[],game:null}},mounted:function(){this.game=this.$refs.game},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=window.location.origin.replace("8080","3000"),t.next=3,fetch(n+"/games");case 3:return r=t.sent,t.next=6,r.json();case 6:o=t.sent,e.games=o,e.showMenu=!0,e.showGame=!1;case 10:case"end":return t.stop()}}),t)})))()},methods:{select:function(e,t){console.log("select "+t.id),this.showMenu=!1,this.showGame=!0,this.game.launch(t)},quitGame:function(){this.showMenu=!0,this.showGame=!1}}},q=D,L=(n("034f"),Object(v["a"])(q,o,s,!1,null,null,null)),R=L.exports;r["a"].config.productionTip=!1;var I=new r["a"]({render:function(e){return e(R)}});I.$mount("#app")},6087:function(e,t,n){},"6b73":function(e,t,n){e.exports=n.p+"img/Loire-Atlantique.7d04f662.jpg"},"6f45":function(e,t,n){},"7b19":function(e,t,n){e.exports=n.p+"img/congo.f2465f13.webp"},"85ec":function(e,t,n){},"8e2a":function(e,t,n){},"95cd":function(e,t,n){var r={"./Loire-Atlantique.jpg":"6b73","./affiche-departements-francais.jpg":"f64f","./congo.webp":"7b19","./iStock-532961103.webp":"bbe3","./plaque-numero.jpg":"c58d"};function o(e){var t=s(e);return n(t)}function s(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id="95cd"},b9ac:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_kevin_dev_dept_quiz_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("1da1"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("96cf"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("5319"),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__);__webpack_exports__["a"]={name:"Highscores",data:function(){return{game:[],players:[],showHighscores:!1}},methods:{show:function show(game){var _this=this;return Object(_home_kevin_dev_dept_quiz_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__["a"])(regeneratorRuntime.mark((function _callee(){var url,response,data,p;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.game=game,url=window.location.origin.replace("8080","3000"),_context.next=4,fetch(url+"/highscore?type=s&game="+game.id+"&ts="+Date.now());case 4:return response=_context.sent,_context.next=7,response.json();case 7:for(p in data=_context.sent,_this.players=data,_this.players)_this.players[p].position=eval(p)+1;_this.showHighscores=!0;case 11:case"end":return _context.stop()}}),_callee)})))()},close:function(){this.showHighscores=!1}}}},bbe3:function(e,t,n){e.exports=n.p+"img/iStock-532961103.fb5e46ac.webp"},c58d:function(e,t,n){e.exports=n.p+"img/plaque-numero.72bb23f1.jpg"},f575:function(e,t,n){"use strict";n("8e2a")},f64f:function(e,t,n){e.exports=n.p+"img/affiche-departements-francais.b7fe9a6b.jpg"},f830:function(e,t,n){"use strict";n("6f45")}});
//# sourceMappingURL=app.a16ff708.js.map